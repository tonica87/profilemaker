<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>生徒プロフィール作成ツール</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .icon {
            width: 16px;
            height: 16px;
            display: inline-block;
            vertical-align: middle;
        }
    </style>
</head>
<body class="bg-gray-100">
    <div class="max-w-6xl mx-auto p-6 bg-white">
        <div class="mb-8">
            <h1 class="text-3xl font-bold text-gray-800 mb-2">生徒プロフィール作成ツール</h1>
            <p class="text-gray-600 mb-4">入力された情報を整理して、指定のテンプレートに沿った文章を自動生成します</p>
            
            <div class="bg-gray-100 p-4 rounded-lg">
                <div class="flex items-center gap-4">
                    <label class="flex items-center cursor-pointer bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                        📁 JSONファイルを読み込み
                        <input type="file" accept=".json" id="jsonFileInput" class="hidden" />
                    </label>
                    <span class="text-sm text-gray-600">
                        保存した生徒プロフィールのファイルを読み込んで編集ができます
                    </span>
                </div>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <div class="space-y-6">
                <!-- 1. 生徒名 -->
                <div class="bg-orange-50 p-6 rounded-lg">
                    <h2 class="text-xl font-semibold mb-4 text-orange-800">生徒名</h2>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">生徒氏名</label>
                            <input type="text" id="studentName" placeholder="例: 武田塾花子" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500" />
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">特訓種別・科目</label>
                            <input type="text" id="trainingType" placeholder="個別S英語" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500" />
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">担当</label>
                            <input type="text" id="instructor" placeholder="担当名を入力" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500" />
                        </div>
                    </div>
                </div>

                <!-- 2. 基本情報 -->
                <div class="bg-blue-50 p-6 rounded-lg">
                    <h2 class="text-xl font-semibold mb-4 text-blue-800">基本情報</h2>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">学年</label>
                            <select id="grade" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <option value="">選択してください</option>
                                <option value="既卒">既卒</option>
                                <option value="高校3年生">高校3年生</option>
                                <option value="高校2年生">高校2年生</option>
                                <option value="高校1年生">高校1年生</option>
                                <option value="中学3年生">中学3年生</option>
                                <option value="中学2年生">中学2年生</option>
                                <option value="中学1年生">中学1年生</option>
                                <option value="その他">その他</option>
                                <option value="学年を記載しない">学年を記載しない</option>
                            </select>
                            <div id="gradeOtherDiv" class="mt-2 hidden">
                                <input type="text" id="gradeOther" placeholder="学年を入力してください" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" />
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">学校区分</label>
                            <div class="flex flex-wrap gap-4">
                                <label class="flex items-center">
                                    <input type="radio" name="schoolType" value="出身校" checked class="mr-2" />
                                    出身校
                                </label>
                                <label class="flex items-center">
                                    <input type="radio" name="schoolType" value="在籍校" class="mr-2" />
                                    在籍校
                                </label>
                                <label class="flex items-center">
                                    <input type="radio" name="schoolType" value="学校を記載しない" class="mr-2" />
                                    学校を記載しない
                                </label>
                            </div>
                        </div>
                        <div id="schoolDiv">
                            <label class="block text-sm font-medium text-gray-700 mb-1" id="schoolLabel">出身校</label>
                            <input type="text" id="school" placeholder="例: 都立上野高校" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" />
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">受験科目（得意な順番で）</label>
                            <input type="text" id="subjects" placeholder="例: 英語>日本史>国語(現古漢)" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" />
                        </div>
                    </div>
                </div>

                <!-- 3. 志望校 -->
                <div class="bg-green-50 p-6 rounded-lg">
                    <h2 class="text-xl font-semibold mb-4 text-green-800">志望校</h2>
                    <p class="text-sm text-green-700 mb-4">可能な限り学部学科まで</p>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">第一志望群</label>
                            <input type="text" id="firstChoice" placeholder="例: 早稲田大学文化構想学部" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500" />
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">第二志望群</label>
                            <input type="text" id="secondChoice" placeholder="例: 中央大学文学部" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500" />
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">第三志望群</label>
                            <input type="text" id="thirdChoice" placeholder="例: 日本大学文理学部" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500" />
                        </div>
                    </div>
                </div>

                <!-- 4. 月別学習到達目標 -->
                <div class="bg-yellow-50 p-6 rounded-lg">
                    <h2 class="text-xl font-semibold mb-4 text-yellow-800">月別学習到達目標</h2>
                    <p class="text-sm text-yellow-700 mb-4">○月○週目のように細かく書きたい場合は一度プロフィール作成してから手打ちで修正してください<br />すべての月の目標を記入しなくても大丈夫ですが、段階突破目標は最低限記入してください</p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">2月末</label>
                            <input type="text" id="february" placeholder="例: 参考書の完成や段階突破、模試の偏差値など" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-500" />
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">3月末</label>
                            <input type="text" id="march" placeholder="例: 参考書の完成や段階突破、模試の偏差値など" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-500" />
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">4月末</label>
                            <input type="text" id="april" placeholder="例: 参考書の完成や段階突破、模試の偏差値など" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-500" />
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">5月末</label>
                            <input type="text" id="may" placeholder="例: 参考書の完成や段階突破、模試の偏差値など" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-500" />
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">6月末</label>
                            <input type="text" id="june" placeholder="例: 参考書の完成や段階突破、模試の偏差値など" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-500" />
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">7月末</label>
                            <input type="text" id="july" placeholder="例: 参考書の完成や段階突破、模試の偏差値など" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-500" />
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">8月末</label>
                            <input type="text" id="august" placeholder="例: 参考書の完成や段階突破、模試の偏差値など" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-500" />
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">9月末</label>
                            <input type="text" id="september" placeholder="例: 参考書の完成や段階突破、模試の偏差値など" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-500" />
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">10月末</label>
                            <input type="text" id="october" placeholder="例: 参考書の完成や段階突破、模試の偏差値など" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-500" />
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">11月末</label>
                            <input type="text" id="november" placeholder="例: 参考書の完成や段階突破、模試の偏差値など" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-500" />
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">12月末</label>
                            <input type="text" id="december" placeholder="例: 参考書の完成や段階突破、模試の偏差値など" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-500" />
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">1月末</label>
                            <input type="text" id="january" placeholder="例: 参考書の完成や段階突破、模試の偏差値など" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-500" />
                        </div>
                    </div>
                </div>

                <!-- 5. 模試成績 -->
                <div class="bg-purple-50 p-6 rounded-lg">
                    <h2 class="text-xl font-semibold mb-4 text-purple-800">直近の模試の成績</h2>
                    <div class="space-y-4">
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">実施日</label>
                                <input type="text" id="examDate" placeholder="例: 4/25" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500" />
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">模試名</label>
                                <input type="text" id="examName" placeholder="例: 第2回全統共通テスト模試" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500" />
                            </div>
                        </div>
                        
                        <div id="examSubjects">
                            <div class="exam-subject mb-4">
                                <div class="flex items-center justify-between mb-2">
                                    <span class="text-sm font-medium text-gray-700">英語</span>
                                </div>
                                <div class="grid grid-cols-3 gap-2">
                                    <input type="text" placeholder="得点" class="subject-score px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500" />
                                    <input type="text" placeholder="満点" class="subject-total px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500" />
                                    <input type="text" placeholder="偏差値" class="subject-deviation px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500" />
                                </div>
                            </div>
                        </div>

                        <div class="flex gap-2 mb-4">
                            <input type="text" id="newSubject" placeholder="科目名を入力" class="flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500" />
                            <button type="button" id="addSubjectBtn" class="px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors">追加</button>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">その他科目</label>
                            <textarea id="examOther" placeholder="その他の科目がある場合は記入" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500" rows="2"></textarea>
                        </div>
                    </div>
                </div>

                <!-- 6. 試験日程 -->
                <div class="bg-red-50 p-6 rounded-lg">
                    <h2 class="text-xl font-semibold mb-4 text-red-800">試験日程</h2>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">模擬試験/英検等の日程</label>
                        <textarea id="examSchedule" placeholder="例:&#10;6/28 駿台ベネッセ模試&#10;8/24 河合塾全統マーク模試&#10;8/31 河合塾全統記述模試" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500" rows="4"></textarea>
                    </div>
                </div>

                <!-- 7. スケジューリング -->
                <div class="bg-indigo-50 p-6 rounded-lg">
                    <h2 class="text-xl font-semibold mb-4 text-indigo-800">1日のスケジューリング</h2>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">各科目の目標勉強時間</label>
                            
                            <div id="studySubjects">
                                <div class="study-subject mb-4">
                                    <div class="flex items-center justify-between mb-2">
                                        <span class="text-sm font-medium text-gray-700">英語</span>
                                    </div>
                                    <div class="flex items-center gap-2">
                                        <input type="text" placeholder="4" class="study-hours w-20 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500" />
                                        <span class="text-gray-600">時間</span>
                                    </div>
                                </div>
                            </div>

                            <div class="flex gap-2 mb-4">
                                <input type="text" id="newStudySubject" placeholder="科目名を入力" class="flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500" />
                                <button type="button" id="addStudySubjectBtn" class="px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition-colors">追加</button>
                            </div>
                        </div>

                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">起床時間</label>
                                <input type="text" id="wakeTime" placeholder="7:30" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500" />
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">就寝時間</label>
                                <input type="text" id="sleepTime" placeholder="23:30" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500" />
                            </div>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">スケジュールを記入</label>
                            <textarea id="schedule" placeholder="例:&#10;6:30 起床&#10;7:00-8:00 朝食・準備&#10;8:00-12:00 午前学習&#10;12:00-13:00 昼食・休憩" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 resize-y" rows="4"></textarea>
                        </div>
                    </div>
                </div>

                <div class="flex space-x-4">
                    <button id="generateBtn" class="flex-1 bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors font-semibold">
                        プロフィール作成
                    </button>
                    <button id="downloadBtn" class="flex items-center justify-center px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors">
                        💾 ダウンロード
                    </button>
                    <button id="clearBtn" class="flex items-center justify-center px-6 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">
                        🔄 クリア
                    </button>
                </div>
            </div>

            <div class="space-y-6">
                <div class="bg-gray-50 p-6 rounded-lg">
                    <div class="flex items-center justify-between mb-4">
                        <h2 class="text-xl font-semibold text-gray-800">作成されたプロフィール</h2>
                        <button id="copyBtn" class="flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors hidden">
                            📋 コピー
                        </button>
                    </div>
                    <div id="usage-info" class="bg-blue-50 p-3 rounded-lg mb-4 hidden">
                        <ul class="text-sm text-blue-700 space-y-1">
                            <li>• 作成されたテキストは直接編集可能です</li>
                            <li>• 「コピー」ボタンでクリップボードにコピーできます</li>
                            <li>• 必要に応じて手動で調整・追記してください</li>
                            <li>• 模試結果や学習進捗に応じて定期的に更新してください</li>
                        </ul>
                    </div>
                    <div class="bg-white p-4 rounded-lg border min-h-96">
                        <textarea id="generatedText" class="w-full h-96 p-3 text-sm text-gray-800 font-mono leading-relaxed border-none resize-none focus:outline-none hidden" placeholder="作成されたプロフィールがここに表示されます"></textarea>
                        <p id="placeholder-text" class="text-gray-500 text-center py-8">
                            左側のフォームに入力して「プロフィール作成」ボタンを押してください
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // フォームデータを管理するオブジェクト
        const formData = {
            examSubjects: [{ name: '英語', score: '', total: '', deviation: '' }],
            studySubjects: [{ name: '英語', hours: '' }]
        };

        // 学年選択の処理
        document.getElementById('grade').addEventListener('change', function() {
            const gradeOtherDiv = document.getElementById('gradeOtherDiv');
            if (this.value === 'その他') {
                gradeOtherDiv.classList.remove('hidden');
            } else {
                gradeOtherDiv.classList.add('hidden');
            }
        });

        // 学校区分の処理
        document.querySelectorAll('input[name="schoolType"]').forEach(radio => {
            radio.addEventListener('change', function() {
                const schoolDiv = document.getElementById('schoolDiv');
                const schoolLabel = document.getElementById('schoolLabel');
                
                if (this.value === '学校を記載しない') {
                    schoolDiv.classList.add('hidden');
                } else {
                    schoolDiv.classList.remove('hidden');
                    schoolLabel.textContent = this.value;
                }
            });
        });

        // 模試科目の追加
        document.getElementById('addSubjectBtn').addEventListener('click', function() {
            const newSubjectInput = document.getElementById('newSubject');
            const subjectName = newSubjectInput.value.trim();
            
            if (subjectName && !formData.examSubjects.find(s => s.name === subjectName)) {
                formData.examSubjects.push({ name: subjectName, score: '', total: '', deviation: '' });
                renderExamSubjects();
                newSubjectInput.value = '';
            }
        });

        // 勉強科目の追加
        document.getElementById('addStudySubjectBtn').addEventListener('click', function() {
            const newStudySubjectInput = document.getElementById('newStudySubject');
            const subjectName = newStudySubjectInput.value.trim();
            
            if (subjectName && !formData.studySubjects.find(s => s.name === subjectName)) {
                formData.studySubjects.push({ name: subjectName, hours: '' });
                renderStudySubjects();
                newStudySubjectInput.value = '';
            }
        });

        // 模試科目の表示
        function renderExamSubjects() {
            const container = document.getElementById('examSubjects');
            container.innerHTML = '';
            
            formData.examSubjects.forEach((subject, index) => {
                const div = document.createElement('div');
                div.className = 'exam-subject mb-4';
                div.innerHTML = `
                    <div class="flex items-center justify-between mb-2">
                        <span class="text-sm font-medium text-gray-700">${subject.name}</span>
                        ${formData.examSubjects.length > 1 ? `<button type="button" onclick="removeExamSubject(${index})" class="text-red-600 hover:text-red-800 text-sm">削除</button>` : ''}
                    </div>
                    <div class="grid grid-cols-3 gap-2">
                        <input type="text" placeholder="得点" value="${subject.score}" onchange="updateExamSubject(${index}, 'score', this.value)" class="px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500" />
                        <input type="text" placeholder="満点" value="${subject.total}" onchange="updateExamSubject(${index}, 'total', this.value)" class="px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500" />
                        <input type="text" placeholder="偏差値" value="${subject.deviation}" onchange="updateExamSubject(${index}, 'deviation', this.value)" class="px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500" />
                    </div>
                `;
                container.appendChild(div);
            });
        }

        // 勉強科目の表示
        function renderStudySubjects() {
            const container = document.getElementById('studySubjects');
            container.innerHTML = '';
            
            formData.studySubjects.forEach((subject, index) => {
                const div = document.createElement
